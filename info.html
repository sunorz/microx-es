<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="google" content="notranslate">
        <meta name="color-scheme" content="light dark">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Información - Alta gama de fachada</title>
        <link rel="icon" href="data:;base64,=">
        <link rel="stylesheet" href="assets/info.min.css?v=2.3.37.1">
    </head>
    <body>
        <div class="header"><a href="x.html"><svg t="1746847106578" viewBox="0
                    0 1024 1024" version="1.1"
                    xmlns="http://www.w3.org/2000/svg" p-id="1568" width="32"
                    height="32"><path class="icon" d="M446.31 135.36c59.14-32.57
                        133.57-17.46 177.33 32.42 20.22 23.05 36.34 49.86 53.08
                        75.76 54.92 85.02 109.37 170.34 163.78 255.69 14.68
                        23.02 11.74 37.13-10.11 53.81-3.85 2.94-7.82 5.8-12.04
                        8.17-32.65 18.35-40.83
                        16.37-60.85-14.6-71.42-110.44-143.06-220.74-214.09-331.43-20.69-32.24-49.06-54.85-82.48-72.11-4.21-2.17-8.4-4.43-14.62-7.71zM165.01
                        653.32c-20.77-42.48-23.41-82.99-0.47-119.52C213.2 456.32
                        265.31 381 315.98 304.77c28.85-43.4 58.17-86.5
                        86.11-130.47 8.39-13.21 18.19-15.94 29.93-9.09 19.47
                        11.36 37.87 24.56 55.3 36.05-68.12 106.25-134
                        208.45-199.16 311.1-14.88 23.45-27.1 48.58-41 72.66-2.48
                        4.3-6.62 8.65-11.05 10.66-27.47 12.48-52.05 28.44-71.1
                        57.64zM702.39 785.54c-47.62 32.71-93.48 64.21-141.88
                        97.46-0.68-7.98-1.5-13.09-1.5-18.2-0.08-70.43
                        0.39-140.87-0.36-211.3-0.19-17.39 5.33-23.46 22.96-23.11
                        47.95 0.96 95.97-0.91 143.89 0.67 52.88 1.75 95.25-19.04
                        131.85-54.99 3.36-3.3 6.85-6.48 10.48-9.92 14.29 27.24
                        6.02 74.23-20.03 101.21-28.96 29.99-63.04 50.9-107.28
                        49.31-23.04-0.83-46.14 0.14-69.21-0.16-11.27-0.15-17.1
                        3.87-16.39 15.94 0.89 15.09-4.26 34.43 3.27 44.05 6.65
                        8.49 27.13 6.14 44.2 9.04zM468.81
                        880.48c-45.78-32.29-91.55-64.57-141.87-100.06h48.12v-60.93c-62.01-2.91-128.66
                        10.55-183.11-37.54 14.52-26.2 37.09-42.29 60.66-57.17
                        2.63-1.66 6.9-1.38 10.32-1.06 32.99 3.08 65.9 7.84 98.95
                        9.16 32.06 1.28 64.27-0.59 96.39-1.8 11.18-0.42 17.17
                        2.18 17.13 14.68-0.23 77.57-0.12 155.15-0.12 232.72-2.16
                        0.66-4.31 1.33-6.47 2z" fill="#ffffff" p-id="1569"></path></svg><span
                    style="display:inline-block;transform:
                    translate(5px,-8px);">Alta gama de fachada</span></a></div>
        <div class="tweet">
            <div class="tweet-content">
                <div class="tweet-header"><h2>Información de derechos de autor</h2></div>
                <div class="tweet-text">
                    <ul>
                        <li>Fondo de la tarjeta de información - <a href="images/profile.jpg?v=3">profile.jpg</a>
                            - <strong>Peter Hujar </strong><em>Nude Self-Portrait, #3</em></li>
                        <li>Icono de hongo - <img src="images/google-icon.svg" alt=""
                                height="18"> - CRÉDITO : <a
                                href="//www.iconfont.cn/user/detail?uid=12656189&nid=EKah83c1bmwx"
                                target="_blank">qiqilili</a></li>
                        <li>Icono de persona - <svg xmlns="http://www.w3.org/2000/svg"
                                version="1.1" viewBox="0 0 116.68 95.43"
                                width="18" height="18">

                                <path class="st0"
                                    d="M116.68,40.28c0,5.38-4.36,9.74-9.74,9.74s-9.74-4.36-9.74-9.74,4.36-9.74,9.74-9.74,9.74,4.36,9.74,9.74Z"
                                    />
                                    <g>
                                        <path class="st0"
                                            d="M106.58,63.61c-.55-.33-1.13-.57-1.72-.71-.6-.16-1.24-.24-1.89-.2l-12.18.52c-1.32-1.98,7.68-7.16,9.9-9.9.54-.66.98-1.56,1.29-2.58-3.7-1.76-6.32-5.41-6.59-9.71-.26.02-.52.04-.8.07-23.6,2.48-31.52,22.7-35.15,27.55l-9.47,13.94-21.58,1.49c-2.73.06-4.89,2.32-4.83,5.05.06,2.73,2.33,4.89,5.05,4.83l24.89.53c2.19-.05,4.07-1.26,5.1-3.02l7.68-9.53,6.34-19.66h1.94l-2.19,6.79-6,18.62c-.73,1.96.27,4.14,2.23,4.87,1.96.73,4.14-.27,4.87-2.23l7.61-18.02,4.24-10.03h2l-5.43,12.86c.84-.01,1.67-.02,2.46-.04l9.44-.14-6.22,12.98c-1.42,2.33-.67,5.37,1.66,6.79s5.37.67,6.79-1.66l12.59-21.12c1.74-2.86.82-6.59-2.04-8.33Z"
                                            />
                                            <path class="st0"
                                                d="M82.39,39.45l1.5,2.3c3.1-1.19,6.55-2.06,10.4-2.47l-4.41-5.34-9.85-11.93c-.98-1.33-3.14-1.41-4.83-.17-1.69,1.24-2.26,3.33-1.28,4.66l8.47,12.95Z"
                                                />
                                            </g>
                                            <g>
                                                <path class="st0"
                                                    d="M69.07,9.11c-.32-.46-1.01-.53-1.54-.16l-1.27.89c-.53.37-.69,1.04-.37,1.5l12.64,18.02c.32.46,1.01.53,1.54.16l1.27-.89c.53-.37.7-1.04.37-1.5l-12.64-18.02Z"
                                                    />
                                                    <path class="st0"
                                                        d="M1.4,2.48c.34,5.22,1.36,10.42,2.88,15.44.77,2.51,1.67,4.97,2.75,7.35,1.08,2.37,2.34,4.67,3.88,6.73.77,1.02,1.62,1.99,2.56,2.81.94.82,1.99,1.5,3.11,1.87,1.12.38,2.3.41,3.42.08,1.12-.32,2.17-.98,3.11-1.79,1.89-1.64,3.3-3.81,4.67-6.06,1.36-2.24,2.63-4.56,3.89-6.88,2.52-4.65,4.91-9.42,8.05-13.85,1.58-2.19,3.37-4.32,5.69-5.96,1.16-.81,2.46-1.48,3.88-1.85,1.41-.38,2.91-.45,4.34-.24,2.88.42,5.41,1.8,7.64,3.38,2.24,1.6,4.22,3.45,6.09,5.4,3.71,3.91,6.94,8.19,9.99,12.57l-1.81,1.25c-2.98-4.34-6.13-8.57-9.7-12.38-1.79-1.89-3.68-3.68-5.76-5.18-2.06-1.48-4.34-2.7-6.74-3.06-1.19-.18-2.39-.13-3.55.18-1.15.3-2.25.84-3.27,1.54-2.04,1.41-3.74,3.38-5.26,5.47-3.04,4.22-5.45,8.94-8.01,13.59-1.27,2.33-2.57,4.66-3.98,6.94-1.39,2.25-2.91,4.6-5.06,6.44-1.07.91-2.32,1.7-3.76,2.11-1.43.41-3.01.36-4.4-.13-1.4-.47-2.61-1.29-3.66-2.21-1.05-.93-1.96-1.97-2.77-3.07-1.62-2.2-2.91-4.6-4.01-7.05-1.1-2.46-2.01-4.99-2.78-7.55C1.32,13.21.32,7.92,0,2.56l1.4-.08Z"
                                                        />
                                                    </g>
                                                </svg> - LICENCIA : <a
                                                    href="//pictogram2.com/"
                                                    target="_blank">人間ピクトグラム素材のギャラリー</a></li>
                                            <li>Complemento - <a href="//videojs.com/"
                                                    target="_blank">video.js</a>
                                                / <a
                                                    href="//html2canvas.hertzen.com/"
                                                    target="_blank">html2canvas</a> / <a href="https://github.com/dmhendricks/file-icon-vectors" target="_blank">File Icon Vectors 1.0</a></li>
                                        </ul>
                                    </div>
                                    <div class="tweet-header"><h2>Código fuente en GitHub</h2></div>
                                    <div class="tweet-text">
<p>Descarga del código <a href="//github.com/sunorz/micro-twitter" target="_blank"><img src="https://img.shields.io/github/v/release/sunorz/micro-twitter?style=flat&logo=github&color=2ecc71" style="vertical-align:middle;margin-left:0.5rem;"></a></p>
                                  
<p>Parte del código de este proyecto fue generado con la asistencia de <a href="//deepseek.com" target="_blank">DeepSeek Chat</a>, <a href="//www.doubao.com" target="_blank">Doubao AI</a> y <a href="//chatgpt.com/" target="_blank">ChatGPT</a>.
</p>
                                        <h3>Registro de actualizaciones</h3>
                                        <div class="log">
                                            <div class="pit-top">
                                            </div>
                                            <div class="pit">
                                                <img src="images/pit-coin-flip.gif">
                                                <img src="images/250819-1.webp">
                                                <img src="images/pit-pickaxe.gif">
                                                <img src="images/pit-rope.gif?v=2">
                                                <img src="images/pit-beef.gif?v=2">
                                                <img src="images/pit-monster.gif?v=4">
                                            </div>
                                            <span>2.2.2</span><ul>

<li>Nueva función: transición del inicio al contenido en modo claro. <mark>#ChatGPT</mark></li>
<li>Nueva función: soporte para formato de video m3u8. <mark>#ChatGPT</mark></li>
<li>Modificación: cambiar comentarios por reenvíos.</li>
<li>Modificación: ajuste de diseño de la página de archivo (1/2). <mark>#ChatGPT</mark></li>
<li>Modificación: rediseño de la función de crecimiento de seguidores. <mark>#ChatGPT</mark></li>
<li>Modificación: el conteo mensual de seguidores en la página de archivo ahora se calcula automáticamente. <mark>#ChatGPT</mark></li>
<li>Corrección: carga automática de audio. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3</span><ul>
<li>Nueva función: autenticación en todas las páginas de contenido. <mark>#ChatGPT</mark></li>
<li>Modificación: algunos íconos.</li>
</ul>
<span>2.3.1</span><ul>
<li>Nueva función: efectos dinámicos en el panel de administración. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.2</span><ul>
<li>Nueva función: generar imagen al hacer clic en reenvío. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.3</span><ul>
<li>Modificación: ajuste de diseño de la página de archivo (2/2).</li>
</ul>
<span>2.3.4</span><ul>
<li>Corrección: orden de verificación confuso. <mark>#Doubao AI</mark></li>
<li>Corrección: lógica de inicio en modo claro.</li>
</ul>
<span>2.3.5</span><ul>
<li>Corrección: redirección de inicio sin key.</li>
<li>Corrección: temblor del fondo al cambiar tamaño de ventana en el panel. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.6</span><ul>
<li>Nueva función: mostrar parte del contenido del Tweet más reciente en la página de archivo.</li>
<li>Corrección: transición inconsistente del inicio al contenido en modo claro. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.7</span><ul>
<li>Corrección: indicaciones de depuración de PHP activadas por defecto. <mark>#ChatGPT</mark></li>
<li>Nueva función: estadísticas de tipos de archivo. <mark>#ChatGPT</mark></li>
<li>Modificación: botón de publicar.</li>
<li>Modificación: cifrado de key. <mark>#Doubao AI</mark></li>
</ul>
<span>2.3.8</span><ul>
<li>Nueva función: soporte de archivo, eliminación y modificación de Tweets (texto original y traducido). <mark>#DeepSeek Chat #ChatGPT</mark></li>
</ul>
<span>2.3.9</span><ul>
<li>Corrección: desorden de estilo e interacción en diálogos. <mark>#ChatGPT</mark></li>
<li>Corrección: error de archivo intermensual. <mark>#ChatGPT</mark></li>
<li>Corrección: marca de agua de imagen compartida excede los límites. <mark>#ChatGPT</mark></li>
<li>Corrección: el total de Tweets no aumentaba debido a la incorporación de ID. <mark>#ChatGPT</mark></li>
<li>Modificación: maquetación de imágenes compartidas.</li>
<li>Corrección: desalineación en la página de archivo tras publicar imágenes. </li>
<li>Corrección: seguridad del panel (1/2). <mark>#ChatGPT</mark></li>
<li>Corrección: visualización de íconos inconsistente en Edge con modo oscuro forzado. <mark>#ChatGPT</mark></li>
<li>Corrección: problemas de interacción con la capa de máscara (1/2). <mark>#Doubao AI</mark></li>
</ul>
<span>2.3.10</span><ul>
<li>Corrección: seguridad del panel (2/2).</li>
<li>Corrección: botón de reenvío en móvil inactivo. <mark>#ChatGPT</mark></li>
<li>Corrección: problemas de interacción con la capa de máscara (2/2). <mark>#Doubao AI</mark></li>
<li>Modificación: menú emergente. <mark>#Doubao AI</mark></li>
<li>Corrección: la capa de máscara no estaba difuminada. <mark>#Doubao AI</mark></li>
</ul>
<span>2.3.11</span><ul>
<li>Corrección: actualización de caché de CSS y JS. <mark>#Doubao AI</mark></li>
<li>Modificación: diseño de página de archivo. <mark>#Doubao AI</mark></li>
<li>Eliminación: íconos innecesarios.</li>
</ul>
<span>2.3.12</span><ul>
<li>Corrección: error al compartir imágenes sin iniciar sesión. <mark>#ChatGPT</mark></li>
<li>Corrección: error al solicitar imágenes. <mark>#Doubao AI</mark></li>
</ul>
<span>2.3.13</span><ul>
<li>Corrección: desalineación de tamaño tras solicitar imágenes. <mark>#Doubao AI</mark></li>
<li>Corrección: error de carga de derechos de autor de medios. <mark>#Doubao AI</mark></li>
<li>Corrección: problema de reproducción m3u8. <mark>#Doubao AI</mark></li>
<li>Corrección: ventana de verificación y otros problemas de validación. <mark>#Doubao AI</mark></li>
<li>Corrección: icono de carga en página de archivo en modo oscuro no cambia de color.</li>
</ul>
<span>2.3.14</span><ul>
<li>Corrección: flujo de verificación de medios confuso. <mark>#Doubao AI</mark></li>
<li>Corrección: interacción incoherente al solicitar archivo m3u8. <mark>#Doubao AI</mark></li>
<li>Nueva función: código de error en solicitudes. <mark>#Doubao AI</mark></li>
</ul>
<span>2.3.15</span><ul>
<li>Corrección: tamaño de video 0 en iOS. <mark>#Doubao AI</mark></li>
<li>Nueva función: un huevo de pascua. <mark>#ChatGPT #Doubao AI</mark></li>
</ul>
<span>2.3.16</span><ul>
<li>Modificación: archivo y eliminación mediante envío asincrónico. <mark>#Doubao AI</mark></li>
<li>Corrección: huevo de pascua (1/3).</li>
<li>Corrección: plantilla de código para publicación de audio.</li>
</ul>
<span>2.3.17</span><ul>
<li>Corrección: actualización de caché en algunas imágenes.</li>
<li>Corrección: problemas de interacción con el reproductor de audio. <mark>#ChatGPT #Doubao AI</mark></li>
</ul>
<span>2.3.18</span><ul>
<li>Corrección: huevo de pascua (2/3). <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.19</span><ul>
<li>Nueva función: agregar avatar histórico y fondo de tarjeta de perfil en archivos. <mark>#ChatGPT</mark></li>
<li>Modificación: script compartido para compartir imágenes en detalles de archivo. <mark>#ChatGPT</mark></li>
<li>Modificación: nombre al guardar imágenes. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.20</span><ul>
<li><del title="No completamente compatible">Corrección: animación de íconos en iOS ineficaz.</del></li>
</ul>
<span>2.3.21</span><ul>
<li>Modificación: cambiar autenticación básica HTTP a TOTP en el panel. <mark>#ChatGPT #Doubao AI</mark></li>
</ul>
<span>2.3.22</span><ul>
<li>Corrección: transmisión de parámetros en el flujo de verificación.</li>
<li>Corrección: permisos residuales por precarga en inicio.</li>
<li>Modificación: animación de página de verificación. <mark>#DeepSeek Chat</mark></li>
</ul>
<span>2.3.23</span><ul>
<li>Corrección: indicaciones de verificación. <mark>#Doubao AI</mark></li>
<li>Eliminación: varias indicaciones de depuración.</li>
<li>Nueva función: soporte de conversión de entidades HTML dentro de &lt;code&gt;, &lt;pre&gt; y &lt;kbd&gt;. <mark>#DeepSeek Chat</mark></li>
<li>Nueva función: sincronización automática a X.com tras traducción de contenido. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.24</span><ul>
<li>Corrección: validación de formato de Tweets antes de sincronizar. <mark>#ChatGPT #Doubao AI</mark></li>
<li>Corrección: devolución de resultados de sincronización al usuario. <mark>#ChatGPT #Doubao AI</mark></li>
<li>Corrección: credenciales expiradas en página de verificación.</li>
<li>Modificación: uso de envío asincrónico en la edición del panel. <mark>#ChatGPT #Doubao AI</mark></li>
<li>Modificación: soporte de cambio entre modo normal y modo sincronización. <mark>#ChatGPT #Doubao AI</mark></li>
</ul>
<span>2.3.25</span><ul>
<li>Corrección: procesamiento de texto antes de sincronizar. <mark>#ChatGPT</mark></li>
<li>Modificación: externalizar todo el código JS inline de la página de visualización.</li>
<li>Nueva función: establecer fondo diario únicamente en la página de visualización. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.26</span><ul>
<li>Corrección: fondo diario. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.27</span><ul>
<li>Corrección: en móvil, la ventana de teclado no oculta el campo de entrada en página de verificación. <mark>#DeepSeek Chat</mark></li>
<li>Corrección: desaparición directa tras error de solicitud de video.</li>
<li>Corrección: mostrar mensaje de error al solicitar video. <mark>#Doubao AI</mark></li>
</ul>
<span>2.3.28</span><ul>
<li>Modificación: visualización dinámica de verificación en inicio. <mark>#Doubao AI</mark></li>
<li>Nueva función: copiar key desde el panel. <mark>#Doubao AI</mark></li>
</ul>
<span>2.3.29</span><ul>
<li>Corrección: reemplazo de puntuación al publicar en inglés. <mark>#ChatGPT</mark></li>
<li>Nueva función: paquete de íconos de archivos.</li>
</ul>
<span>2.3.30</span><ul>
<li>Corrección: temblor de botones en el panel. <mark>#ChatGPT</mark></li>
<li>Corrección: sangría de primera línea en chino al compartir imágenes. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.31</span><ul>
<li>Nueva función: soporte de Markdown en el panel. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.32</span><ul>
<li>Corrección: Tweets largos no mostraban puntos suspensivos en X.com. <mark>#Doubao AI</mark></li>
<li>Corrección: comillas simples en abreviaciones de Tweets se completaban incorrectamente. <mark>#Doubao AI</mark></li>
</ul>
<span>2.3.33</span><ul>
<li>Modificación: interfaz del editor en el panel. <mark>#ChatGPT #Doubao AI</mark></li>
</ul>
<span>2.3.34</span><ul>
<li>Modificación: aumentar complejidad de verificación, reutilización de lógica. <mark>#ChatGPT #Doubao AI</mark></li>
</ul>
<span>2.3.35</span><ul>
<li>Nueva función: modo pantalla completa en el editor del panel. <mark>#ChatGPT #Doubao AI</mark></li>
<li>Corrección: acceso directo al panel desde la lista blanca. <mark>#ChatGPT #Doubao AI</mark></li>
</ul>
<span>2.3.36</span><ul>
<li>Corrección: validación redundante que impedía sincronización a X.com.</li>
</ul>
<span>2.3.37</span><ul>
<li>Nueva función: aviso al cerrar ventana durante edición y publicación. <mark>#Doubao AI</mark></li>
</ul>
<span>2.3.38</span><ul>
<li>Corrección: aviso al cerrar ventana durante edición y publicación. <mark>#Doubao AI</mark></li>
</ul>
<span>2.3.39</span><ul>
<li>Modificación: soporte de reproducción de canciones en CD en la página de archivo. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.40</span><ul>
<li>Modificación: verificación de número de Tweets y mensaje correspondiente. <mark>#Doubao AI</mark></li>
</ul>
<span>2.3.41</span><ul>
<li>Corrección: huevo de pascua (3/3). <mark>#ChatGPT</mark></li>
<li>Corrección: conversión de guiones. <mark>#ChatGPT</mark></li>
<li>Corrección: sincronización de contenido publicado con página de donación. <mark>#ChatGPT</mark></li>
</ul>
<span>2.3.42</span><ul>
<li>Corrección: interacción en página de inicio de sesión.</li>
</ul>

                                        </div>
                                    </div>
                                    <div class="tweet-header"><h2>Información del autor</h2></div>
                                    <div class="tweet-text">Visita <a href="//blog.kkii.org" target="_blank">卡库伊2.0</a>
                                        para más información.
                                    </div>
                                </div></div>
                            <div class="bottom-banner">information</div>
                            <div class="footer">
                                &copy; Alta gama de fachada , <script>const date = new Date(); document.write(date.getFullYear()); 
// 彩蛋
console.log("%c¡Genial! Has encontrado un huevo de pascua. Prueba tocar al minero o la moneda.\n!رائع لقد وجدت سرًا! جرّب النقر على المنجم أو العملة","font-size: 14px; color:#ff5722; direction: rtl;");
console.warn("¿No ves al minero? Solo toca la moneda.\nإذا لم تجد المنجم؟ فقط انقر على العملة"); 



const pit = document.querySelector('.pit');
const coin = pit.children[0];       
const character = pit.children[1];  
const boss = pit.lastElementChild;  
const items = pit.querySelectorAll('img:not(:first-child):not(:nth-child(2)):not(:last-child)');
// 选择.log下的所有span
const spans = document.querySelectorAll('.log span');

const PIT_HEIGHT = 503;
const END_Y = PIT_HEIGHT - 30;
// 定义人物和boss的Y轴范围
const MIN_Y = 20;
const MAX_Y = 450;
let MOVE_SPEED = 1;
let animationId;
let isPaused = false;
let hasAttacked = false;

// debug 模式
const DEBUG_MODE = false; // 假设当前为true
const COOLDOWN_TIME = DEBUG_MODE ? 1 : 60 * 1000 ;

// 延迟函数
function delay(ms) { return new Promise(res => setTimeout(res, ms)); }

// 初始化人物、boss top（随机/调试）并保证不与物品重叠
function initPositions() {
    const now = Date.now();
    const lastCharTime = localStorage.getItem('charLastTime');
    const lastBossTime = localStorage.getItem('bossLastTime');
    const savedCharTop = parseFloat(localStorage.getItem('charTop'));
    const savedBossTop = parseFloat(localStorage.getItem('bossTop'));

    // 1. 直接写死所有空位的top值数组（你的新数组）
    function getAllEmptyPositions() {
        return [0, 20, 75, 150, 170, 260, 290, 300, 330, 350, 400, 440];
    }
    
    // 2. 从空位中随机选出2个值
function getTwoRandomPositions(emptyPositions) {
    // 随机取一个位置
    const first = emptyPositions[Math.floor(Math.random() * emptyPositions.length)];

    // 找到first在数组中的索引
    const idx = emptyPositions.indexOf(first);

    // 把相邻的去掉（idx-1 和 idx+1）
    const filtered = emptyPositions.filter((_, i) => i !== idx - 1 && i !== idx + 1 && i !== idx);

    // 再随机取一个
    const second = filtered[Math.floor(Math.random() * filtered.length)];

    return [first, second];
}

    let charTop, bossTop;
    if (DEBUG_MODE) {
        // 调试模式下的位置处理（修复部分）
        const emptyPositions = getAllEmptyPositions();
        const [pos1, pos2] = getTwoRandomPositions(emptyPositions);
        
        // 确保人物在boss上方，但不修改原始数组值
        if (pos1 < pos2) {
            charTop = pos1; // 上方位置给人物
            bossTop = pos2; // 下方位置给boss
        } else {
            charTop = pos2;
            bossTop = pos1;
        }
        
        // 移除导致位置偏移的代码：charTop = Math.max(MIN_Y, charTop - 50);
    } else {
        if (!lastCharTime || now - lastCharTime > COOLDOWN_TIME || 
            !lastBossTime || now - lastBossTime > COOLDOWN_TIME) {
            // 需要生成新位置
            const emptyPositions = getAllEmptyPositions();
            const [pos1, pos2] = getTwoRandomPositions(emptyPositions);
            
            // 3. 随机分配给人物和boss
            if (Math.random() > 0.5) {
                charTop = pos1;
                bossTop = pos2;
            } else {
                charTop = pos2;
                bossTop = pos1;
            }
            
            // 保存新位置和时间
            localStorage.setItem('charTop', charTop);
            localStorage.setItem('charLastTime', now);
            localStorage.setItem('bossTop', bossTop);
            localStorage.setItem('bossLastTime', now);
        } else {
            // 使用保存的位置
            charTop = savedCharTop || 20; // 默认值使用空位中的值
            bossTop = savedBossTop || 150; // 默认值使用空位中的值
        }
    }

    // 最终检查，确保位置在范围内（不修改数组值）
    if (charTop < MIN_Y) charTop = MIN_Y;
    if (charTop > MAX_Y) charTop = MAX_Y;
    if (bossTop < MIN_Y) bossTop = MIN_Y;
    if (bossTop > MAX_Y) bossTop = MAX_Y;

    character.style.top = charTop + 'px';
    boss.style.top = bossTop + 'px';

    // 其他初始化逻辑...
    items.forEach(item => { item.style.opacity='1'; item.dataset.used='false'; item.style.cursor='default'; });
    boss.style.opacity='1'; boss.style.cursor='default';
    coin.style.opacity='1'; coin.style.cursor='pointer';
    character.style.cursor='pointer';

    hasAttacked = false; isPaused=false;

    // 根据DEBUG_MODE决定span是否隐藏
    spans.forEach(span => {
        span.style.transform = '';
        span.style.transition = 'transform 0.5s ease';
        span.style.display = DEBUG_MODE ? 'none' : 'inline-block';
    });
}

// 其他函数保持不变...
function isColliding(a,b){
    const ra=a.getBoundingClientRect(), rb=b.getBoundingClientRect();
    return !(ra.bottom<rb.top || ra.top>rb.bottom || ra.right<rb.left || ra.left>rb.right);
}

async function handleItemCollision(item){
    if(item.dataset.used==='true') return;
    item.dataset.used='true'; isPaused=true;
    for(let i=0;i<3;i++){ item.style.opacity='0'; await delay(150); item.style.opacity='1'; await delay(150);}
    await delay(1000); item.style.opacity='0'; isPaused=false;
}

async function handleBossCollision(){
    if(hasAttacked) return;
    hasAttacked=true; isPaused=true;

    await delay(1000);
    const originalTop=parseFloat(character.style.top);
    character.style.top=(originalTop-10)+'px';

    for(let i=0;i<6;i++){
        character.style.top=(originalTop + (i%2===0?-5:5))+'px';
        await delay(100);
    }
    character.style.top=originalTop+'px';

    character.style.filter='brightness(0.5) saturate(100%) sepia(100%) hue-rotate(-10deg) saturate(300%)';
    await delay(800);

    boss.style.opacity='0';
    coin.src='images/pit-aid.gif';
    isPaused=false;
}

function triggerSpanAnimation(){
    if(!DEBUG_MODE){
        spans.forEach(span=>{
            span.style.display='inline-block'; 
            span.style.transform='translateX(40px)';
        });
    }
}

function resetSpanAnimation(){
    if(!DEBUG_MODE){
        spans.forEach(span=>{span.style.transform='';});
    }
}

async function handleCoinReached(){
    await delay(3000);
    if(coin.src.includes('pit-aid.gif')){ 
        coin.src='images/pit-aid-get.gif';  
        character.style.filter='';
        }
        else{
            coin.src='images/pit-coin-get.gif'; 
        }
    coin.style.filter='brightness(1.8)'; await delay(800);
    coin.style.opacity='0'; await delay(2000);
    resetSpanAnimation(); coin.style.filter='';
    
}

function animateCharacter(){
    let currentY=parseFloat(character.style.top)||0, lastTime=null;
    function step(timestamp){
        if(!lastTime) lastTime=timestamp;
        const delta=timestamp-lastTime; lastTime=timestamp;
        if(!isPaused){
            currentY+=MOVE_SPEED*(delta/16);
            character.style.top=currentY+'px';
            items.forEach(item=>{if(item.style.opacity!=='0' && isColliding(character,item)) handleItemCollision(item);});
            if(boss.style.opacity!=='0' && isColliding(character,boss)) handleBossCollision();
            if(currentY>=END_Y){cancelAnimationFrame(animationId); handleCoinReached(); return;}
        }
        animationId=requestAnimationFrame(step);
    }
    animationId=requestAnimationFrame(step);
}

window.addEventListener('DOMContentLoaded',()=>{initPositions();});

function startAnimation(){
    triggerSpanAnimation();
    animateCharacter();
    character.style.cursor='default'; coin.style.cursor='default';
    character.removeEventListener('click',startAnimation);
    coin.removeEventListener('click',startAnimation);
}

character.addEventListener('click',startAnimation);
coin.addEventListener('click',startAnimation);

</script>
                            </div>
                        </body>
                    </html>
